{
  "version": "1.0.0",
  "templates": {
    "http_no_encryption": {
      "title": "未使用傳輸層加密 (Missing Transport Layer Encryption)",
      "description": "目標應用程式透過明文 HTTP 協議傳輸數據,未實施 TLS/SSL 加密保護。攻擊者可透過中間人攻擊 (Man-in-the-Middle Attack) 攔截、竊取或篡改傳輸中的敏感資訊,包括但不限於: 登入憑證、會話令牌 (Session Token)、個人識別資訊 (PII) 以及業務關鍵數據。\n\n**技術細節:**\n- 協議: HTTP/1.1 (明文)\n- 端口: {port}\n- 加密狀態: 無加密\n- 風險: 數據可被網路層攔截\n\n**攻擊場景:**\n1. 公共 WiFi 環境下的流量嗅探\n2. ISP 層級的流量監控與注入\n3. 企業內網的 ARP 欺騙攻擊\n4. DNS 劫持配合流量重定向",
      "remediation": "**立即修復措施:**\n\n1. **啟用 HTTPS/TLS 1.3**\n   - 獲取有效的 SSL/TLS 證書 (推薦 Let's Encrypt 免費證書)\n   - 配置 Web 服務器強制使用 HTTPS\n   - 禁用 TLS 1.0/1.1,僅允許 TLS 1.2+ 和 TLS 1.3\n\n2. **實施 HTTP 強制重定向**\n   ```nginx\n   server {\n       listen 80;\n       return 301 https://$server_name$request_uri;\n   }\n   ```\n\n3. **配置 HSTS (HTTP Strict Transport Security)**\n   ```\n   Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\n   ```\n\n4. **證書配置最佳實務**\n   - 使用 2048-bit RSA 或 256-bit ECDSA 金鑰\n   - 啟用 OCSP Stapling\n   - 配置強加密套件 (Cipher Suite)\n\n**驗證方法:**\n```bash\n# 測試 HTTPS 可用性\ncurl -I https://{host}\n\n# 驗證 SSL/TLS 配置\nssl-scan {host}:443\n```\n\n**參考資源:**\n- OWASP Transport Layer Protection Cheat Sheet\n- Mozilla SSL Configuration Generator\n- CWE-319: Cleartext Transmission of Sensitive Information",
      "severity": "high",
      "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
      "cvss_score": 7.4,
      "cwe_id": "CWE-319",
      "owasp_category": "A02:2021 - Cryptographic Failures"
    },
    "info_disclosure_server": {
      "title": "服務器指紋識別資訊洩露 (Server Fingerprinting Information Disclosure)",
      "description": "目標應用程式在 HTTP 響應標頭或特定端點暴露了詳細的伺服器軟體版本資訊、技術堆疊細節或系統架構資訊。此類資訊洩露可協助攻擊者:\n\n1. **精準定位已知漏洞 (CVE)**: 根據版本號查詢公開漏洞數據庫\n2. **優化攻擊向量**: 針對特定技術堆疊定制 Exploit\n3. **降低偵察成本**: 快速建立目標系統指紋\n4. **規劃後續攻擊**: 識別潛在的攻擊面\n\n**洩露資訊類型:**\n- 伺服器軟體及版本 (如: nginx/1.18.0, Apache/2.4.41)\n- 應用程式框架 (如: Express 4.17.1, Django 3.2.0)\n- 程式語言版本 (如: PHP/7.4.3, Python/3.9.5)\n- 作業系統資訊\n- 中介軟體版本\n\n**發現位置:**\n- HTTP Response Headers (Server, X-Powered-By 等)\n- 錯誤頁面堆疊追蹤\n- API 文檔端點 (/info, /actuator/info, /api-docs)\n- 版本資訊文件 (VERSION, CHANGELOG)",
      "remediation": "**修復建議 (依優先級排序):**\n\n**1. 移除或混淆敏感 HTTP 標頭**\n\nNginx 配置:\n```nginx\nserver_tokens off;\nmore_clear_headers 'Server';\nmore_clear_headers 'X-Powered-By';\n```\n\nApache 配置:\n```apache\nServerTokens Prod\nServerSignature Off\nHeader unset X-Powered-By\n```\n\nNode.js/Express:\n```javascript\napp.disable('x-powered-by');\n```\n\n**2. 限制資訊端點訪問**\n```nginx\nlocation ~ ^/(info|health|metrics|actuator) {\n    allow 127.0.0.1;      # 僅本地\n    allow 10.0.0.0/8;     # 內部網段\n    deny all;\n    auth_basic \"Restricted\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n}\n```\n\n**3. 自定義錯誤頁面**\n- 實施統一的錯誤處理機制\n- 避免在錯誤訊息中暴露堆疊追蹤\n- 記錄詳細錯誤到日誌系統,僅向用戶顯示通用訊息\n\n**4. 定期安全審計**\n```bash\n# 檢查 HTTP 標頭\ncurl -I {url} | grep -E 'Server|X-Powered-By|X-AspNet'\n\n# 掃描資訊端點\nwhatweb {url}\nnmap -sV -p80,443 {host}\n```\n\n**5. 實施 Web Application Firewall (WAF)**\n- 配置規則過濾敏感資訊\n- 統一處理出站響應標頭\n\n**風險評估:**\n- 單獨洩露: 低風險 (資訊收集)\n- 配合其他漏洞: 中至高風險 (加速攻擊鏈)\n\n**參考標準:**\n- CWE-200: Exposure of Sensitive Information\n- OWASP ASVS v4.0 - V14.5 HTTP Security Headers\n- NIST SP 800-53 Rev. 5 - SC-8",
      "severity": "low",
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
      "cvss_score": 5.3,
      "cwe_id": "CWE-200",
      "owasp_category": "A05:2021 - Security Misconfiguration"
    }
  }
}
